#!/usr/bin/env node

const
  parseArgs = require('minimist')

const argv = parseArgs(process.argv.slice(2), {
  alias: {
    a: 'add',
    r: 'remove',

    h: 'help'
  },
  boolean: ['h'],
  string: ['a', 'r']
})

if (argv.help) {
  console.log(`
  Description
    Manage Quasar App CLI extensions

  Usage
    $ quasar extension [-a|-r]

  Options
    --add, -a        Add Quasar App CLI extension
    --remove, -r     Remove Quasar App CLI extension
    --help, -h       Displays this message
  `)
  process.exit(0)
}

async function run () {
  const name = argv.add || argv.remove
  if (name) {
    if (!name || !name.length) {
      warn(`⚠️  Please specify app cli extension name`)
      process.exit(1)
    }

    const Extension = require('../lib/cli-extension/Extension')
    const extension = new Extension(name)

    await extension[argv.add ? 'install' : 'uninstall']()
    process.exit(0)
  }

  const extensionJson = require('../lib/cli-extension/extension-json')
  extensionJson.list()
}

run()
